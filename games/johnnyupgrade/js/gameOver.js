var go; var GameOverState = {preload: function(){world = this; this.game.input.keyboard.addKeyCapture(Phaser.Keyboard.SPACEBAR); settings(this); game.stage.backgroundColor = "#000000"; }, create: function() {muPlay('muGameOver', 0.9, true); game.scale.setGameSize(screenWidth, screenHeight); go = {}; go.ani = game.add.group(); go.ani.x = 400; go.ani.y = 260; go.ani.angle = -45; go.c3 = go.ani.add(game.add.tileSprite(0,0, 278, 600, 'goCloud3')); go.c3.anchor.setTo(0.5); go.c2 = go.ani.add(game.add.tileSprite(0,0, 500, 600, 'goCloud2')); go.c2.anchor.setTo(0.5); go.c1 = go.ani.add(game.add.tileSprite(0,0, 700, 600, 'goCloud1')); go.c1.anchor.setTo(0.5); go.m1 = go.ani.add(game.add.sprite(0,0, 'goMask1')); go.m1.anchor.setTo(0.5); go.sprt = go.ani.add(game.make.sprite(0,0, 'goJoe')); go.sprt.xo = go.sprt.x; go.sprt.yo = go.sprt.y; go.sprt.anchor.setTo(0.5); var theEnd = game.add.sprite(380, 0, 'goTheEnd'); theEnd.anchor.setTo(0.5,0); go.txt = game.add.sprite(400,600, 'goText'); go.txt.anchor.setTo(0.5,0); var mask = game.add.graphics(0, 460); mask.beginFill(0xffffff); mask.drawRect(0, 0, 800, 400); go.txt.mask = mask; game.add.sprite(0, 460, 'goMask2'); }, update: function(){go.c3.tilePosition.y += 2; go.c2.tilePosition.y += 6; go.c1.tilePosition.y += 12; go.sprt.x = go.sprt.xo+Math.random()*8-4; go.sprt.y = go.sprt.yo+Math.random()*8-4; go.sprt.angle = Math.random()*4-2; if(!go.c2c){go.txt.y -= 0.5; if(go.txt.y < -144){goShowClick(); } } }, render: function(){rotDeviceCheck(); } }; function goShowClick(){go.c2c = world.game.add.sprite(400, 590, 'btnGOHome'); go.c2c.anchor.setTo(0.5, 1); go.c2c.inputEnabled = true; go.c2c.events.onInputDown.add(goClick); } function goNull(){} function goClick(pointer){if(rotDevice){return;} if(parent && parent.cmgGameEvent){parent.cmgGameEvent('start'); } levl = 0; clickSound(); newState(); }